<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exploratory Data Analysis</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Final_Report_Draft.html">Report</a>
</li>
<li>
  <a href="preliminary_analysis.html">EDA</a>
</li>
<li>
  <a href="conclusion.html">Conclusion</a>
</li>
<li>
  <a href="about_us.html">About the Group</a>
</li>
<li>
  <a href="https://github.com/jl7033/final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exploratory Data Analysis</h1>

</div>


<div id="salaries-data-import-and-cleaning" class="section level2">
<h2>Salaries Data import and cleaning</h2>
<p>Descrition of data cleaning:</p>
<ul>
<li><p>reading in data</p></li>
<li><p>selecting and renaming the columns</p></li>
<li><p>since names are in last, first format, reorder them to be first
last</p></li>
<li><p>make sure all “Jr”s go at the end</p></li>
<li><p>remove accents using stringi::stri_trans_general</p></li>
</ul>
<pre class="r"><code>salaries = read_excel(
  &quot;data/MLB-Salaries 2000-24.xlsx&quot;, 
  sheet = &quot;2022.xls&quot;,
  skip = 1) |&gt;
  select(1:4) |&gt;
  rename(position = &quot;Pos&#39;n&quot;,
         salary_2022 = &quot;2022.0&quot;,
         service_time_yrs = &quot;MLS&quot;,
         name = &quot;Player&quot;) %&gt;%
  mutate(name = str_split(name, &quot;,&quot;),
         name = map(name, rev),       
         name = map_chr(name, str_c, collapse = &quot; &quot;),
         name = str_trim(name),
         name = str_replace_all(name, &quot;[*#\\.,]&quot;, &quot;&quot;),
         junior = str_detect(name, &quot;Jr&quot;),
         name = if_else(junior == TRUE, str_remove(name, &quot; Jr&quot;), name),
         name = if_else(junior == TRUE, str_c(name, &quot; Jr&quot;), name),
         name = stringi::stri_trans_general(name,id = &quot;Latin-ASCII&quot;)) |&gt;
  select(-junior) %&gt;%
  mutate(simple_position = str_split_i(position, &quot;-&quot;, 1),
         simple_position = fct_relevel(simple_position,
                                       c(&quot;c&quot;, &quot;1b&quot;, &quot;2b&quot;, &quot;3b&quot;, &quot;ss&quot;,
                                         &quot;lf&quot;, &quot;cf&quot;, &quot;rf&quot;, &quot;inf&quot;, &quot;of&quot;,
                                         &quot;dh&quot;, &quot;rhp&quot;, &quot;lhp&quot;)),
         service_time_floor = floor(service_time_yrs))</code></pre>
</div>
<div id="batting-and-pitching-data-import-and-cleaning"
class="section level2">
<h2>Batting and Pitching data import and cleaning</h2>
<div id="batting" class="section level3">
<h3>Batting</h3>
<p>Descrition of data cleaning:</p>
<ul>
<li><p>reading in data and clean names</p></li>
<li><p>grouping by name and using a count to ensure we only end up with
one of each name (slightly complicated due to interleague trades and
potential for players with the same name)</p></li>
<li><p>remove whitespace, from names and use stringi again to remove
accents so that the formatting exactly matches the salaries
tibble</p></li>
<li><p>Filter out those with fewer than 100 plate appearances</p></li>
</ul>
<pre class="r"><code>batting = read_delim(&quot;data/2022 MLB Player Stats - Batting.csv&quot;, delim = &quot;;&quot;,
                     locale = locale(encoding = &quot;latin1&quot;)) |&gt;
  janitor::clean_names() %&gt;%
  group_by(name) |&gt;
  mutate(name_count = n(),
         keep_row = case_when(name_count == 1 ~ TRUE,
                              name_count &gt; 1 &amp; tm == &quot;TOT&quot; ~ TRUE,
                              .default = FALSE)) |&gt;
  filter(keep_row == TRUE) %&gt;%
  mutate(name_count = n(),
         keep_row = case_when(name_count == 1 ~ TRUE,
                              name_count &gt; 1 &amp; lg == &quot;MLB&quot; ~ TRUE,
                              .default = FALSE)) |&gt;
  ungroup() |&gt;
  filter(keep_row == TRUE) %&gt;%
  mutate(name = str_split(name, &quot;\\s+&quot;),
         name = map_chr(name, str_c, collapse = &quot; &quot;),
         name = str_trim(name),
         name = str_replace_all(name, &quot;[*#\\.]&quot;, &quot;&quot;),
         name = stringi::stri_trans_general(name,id = &quot;Latin-ASCII&quot;))

merged_batting &lt;- salaries |&gt;
  mutate(simple_position = str_split_i(position, &quot;-&quot;, 1)) |&gt;
  filter(!simple_position %in% c(&quot;rhp&quot;,&quot;lhp&quot;)) |&gt;
  inner_join(batting, by = &quot;name&quot;) |&gt;
  filter(pa &gt;= 100)

salary_not_in_batting &lt;- anti_join(salaries, batting, by = &quot;name&quot;)
batting_not_in_salary &lt;- anti_join(batting, salaries, by = &quot;name&quot;)</code></pre>
</div>
<div id="pitching" class="section level3">
<h3>Pitching</h3>
<p>(same data cleaning process as above)</p>
<pre class="r"><code>pitching = read_delim(&quot;data/2022 MLB Player Stats - Pitching.csv&quot;, delim = &quot;;&quot;,
                     locale = locale(encoding = &quot;latin1&quot;)) |&gt;
  janitor::clean_names() %&gt;%
  group_by(name) |&gt;
  mutate(name_count = n(),
         keep_row = case_when(name_count == 1 ~ TRUE,
                              name_count &gt; 1 &amp; tm == &quot;TOT&quot; ~ TRUE,
                              .default = FALSE)) |&gt;
  filter(keep_row == TRUE) %&gt;%
  mutate(name_count = n(),
         keep_row = case_when(name_count == 1 ~ TRUE,
                              name_count &gt; 1 &amp; lg == &quot;MLB&quot; ~ TRUE,
                              .default = FALSE)) |&gt;
  ungroup() |&gt;
  filter(keep_row == TRUE) %&gt;%
  mutate(name = str_split(name, &quot;\\s+&quot;),
         name = map_chr(name, str_c, collapse = &quot; &quot;),
         name = str_trim(name),
         name = str_replace_all(name, &quot;[*#\\.]&quot;, &quot;&quot;),
         name = stringi::stri_trans_general(name,id = &quot;Latin-ASCII&quot;))

merged_pitching &lt;- inner_join(salaries, pitching, by = &quot;name&quot;) |&gt;
  filter(ip &gt;= 20) |&gt;
  separate(ip, into = c(&quot;ip&quot;, &quot;ip_dec&quot;), remove = FALSE, convert = TRUE) |&gt;
  mutate(ip_dec_333 = ifelse(is.na(ip_dec), 0, ip_dec * 333)  ,
         ip_total = paste(ip, ip_dec_333, sep = &quot;.&quot;),
         ip_total = as.numeric(ip_total)) |&gt;
  select(-ip, -ip_dec, -ip_dec_333) |&gt;
  separate(position, into = c(&quot;hand&quot;, &quot;pitcher_type&quot;)) |&gt;
  mutate(pitcher_type = ifelse(is.na(pitcher_type), &quot;r&quot;, pitcher_type)) |&gt;
  filter(hand == &quot;lhp&quot; | hand == &quot;rhp&quot;)

salary_not_in_pitching &lt;- anti_join(salaries, pitching, by = &quot;name&quot;)
pitching_not_in_salary &lt;- anti_join(pitching, salaries, by = &quot;name&quot;)</code></pre>
<p>Note that there are a number of names in <code>salaries</code> not
found in <code>batting</code> or <code>pitching</code>, and vice versa.
Some of this may be genuine missingness (e.g. salaries has fewer rows
than pitching and batting combined), but some is also due to alternative
spellings of names in the datasets. Possibly could be fixed using other
matching methods, but the analysis pipeline will still work from
here.</p>
</div>
</div>
<div id="salaries-eda" class="section level2">
<h2>Salaries EDA</h2>
<p>Some Basic EDA for salaries on their own</p>
<p>Service time (i.e. number of years of experience)</p>
<pre class="r"><code>salaries |&gt;
  count(service_time_floor) |&gt;
  ggplot(aes(x = service_time_floor, y = n)) + 
  geom_col() + 
  labs(title = &quot;Number of Players per Year of Experience&quot;,
       x = &quot;Years in the MLB&quot;,
       y = &quot;Number of Players&quot;) +
  scale_x_continuous(breaks = seq(0,21,by=1)) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-4-1.png" width="90%" /></p>
<pre class="r"><code>salaries %&gt;%
  group_by(service_time_floor) %&gt;%
  filter(service_time_floor &lt; 4)</code></pre>
<pre><code>## # A tibble: 866 × 6
## # Groups:   service_time_floor [4]
##    name                 position service_time_yrs salary_2022 simple_position
##    &lt;chr&gt;                &lt;chr&gt;               &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;          
##  1 Juan Soto            lf                   3.13    17100000 lf             
##  2 Yusei Kikuchi        lhp-s                3       16000000 lhp            
##  3 Ronald Acuna         lf                   3.16    15000000 lf             
##  4 Ke&#39;Bryan Hayes       3b                   1.08    10000000 3b             
##  5 Seiya Suzuki         of                   0        8000000 of             
##  6 Vladimir Guerrero Jr 3b                   2.16     7900000 3b             
##  7 Pete Alonso          1b                   3        7400000 1b             
##  8 Eloy Jimenez         rf                   3        7333333 rf             
##  9 Walker Buehler       rhp                  3.17     7250000 rhp            
## 10 Max Fried            lhp-s                3.15     6850000 lhp            
## # ℹ 856 more rows
## # ℹ 1 more variable: service_time_floor &lt;dbl&gt;</code></pre>
<p>This is right skewed, so may need to transform it if used in
regression</p>
<p>Salary</p>
<pre class="r"><code>salaries |&gt;
  ggplot(aes(x = salary_2022)) + 
  geom_density() + 
  labs(title = &quot;2022 Salary Distribution&quot;,
       x = &quot;2022 Salary&quot;,
       y = &quot;&quot;) +
  scale_x_continuous(labels = label_comma()) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<pre class="r"><code>salaries |&gt;
  mutate(position_group = case_match(simple_position,
                                     c(&quot;rhp&quot;,&quot;lhp&quot;) ~ &quot;pitcher&quot;,
                                     c(&quot;cf&quot;,&quot;lf&quot;,&quot;rf&quot;,&quot;of&quot;) ~ &quot;outfield&quot;,
                                     &quot;dh&quot; ~ &quot;dh&quot;,
                                     .default = &quot;infield&quot;)) |&gt;
  ggplot(aes(x = salary_2022, color = position_group)) +
  geom_density() +
  labs(title = &quot;Salary by Position Group&quot;,
       x = &quot;2022 Salary&quot;,
       y = &quot;&quot;) +
  scale_x_continuous(labels = label_comma()) +
  scale_color_discrete(name = &quot;Position Group&quot;,
                       labels = c(&quot;Designated Hitter&quot;,
                                &quot;Infield&quot;,
                                &quot;Outfield&quot;,
                                &quot;Pitcher&quot;)) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-5-2.png" width="90%" />
This is also heavily right skewed, with many players having salary under
$1,000,000</p>
<p>Position type table</p>
<pre class="r"><code>merged_batting |&gt;
  count(simple_position) |&gt; 
  mutate(simple_position = fct_infreq(simple_position,w = n)) |&gt;
  ggplot(aes(x = simple_position, y = n)) +
  geom_col() +
  labs(title = &quot;Players per Position&quot;,
       x = &quot;&quot;,
       y = &quot;Number of Players&quot;) +
  scale_x_discrete(guide = guide_axis(angle = 75), 
                  labels = c(&quot;1b&quot; = &quot;1st Base&quot;,
                    &quot;2b&quot; = &quot;2nd Base&quot;,
                    &quot;3b&quot; = &quot;3rd Base&quot;,
                    &quot;inf&quot; = &quot;Infield&quot;,
                    &quot;c&quot; = &quot;Catcher&quot;,
                    &quot;rf&quot; = &quot;Right Field&quot;,
                    &quot;lf&quot; = &quot;Left Field&quot;,
                    &quot;cf&quot; = &quot;Center Field&quot;,
                    &quot;of&quot; = &quot;Outfield&quot;,
                    &quot;lhp&quot; = &quot;Left Hand Pitcher&quot;,
                    &quot;rhp&quot; = &quot;Right Hand Pitcher&quot;,
                    &quot;dh&quot; = &quot;Designated Hitter&quot;,
                    &quot;ss&quot; = &quot;Shortstop&quot;)) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<pre class="r"><code>salaries %&gt;%
  mutate(position_group = case_match(simple_position,
                                     c(&quot;rhp&quot;,&quot;lhp&quot;) ~ &quot;pitcher&quot;,
                                     c(&quot;cf&quot;,&quot;lf&quot;,&quot;rf&quot;,&quot;of&quot;) ~ &quot;outfield&quot;,
                                     &quot;dh&quot; ~ &quot;dh&quot;,
                                     .default = &quot;infield&quot;)) %&gt;%
  ggplot(aes(x=position_group, y=service_time_floor)) +
  geom_boxplot()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-6-2.png" width="90%" /></p>
<pre class="r"><code>salaries %&gt;%
  mutate(position_group = case_match(simple_position,
                                     c(&quot;rhp&quot;,&quot;lhp&quot;) ~ &quot;pitcher&quot;,
                                     c(&quot;cf&quot;,&quot;lf&quot;,&quot;rf&quot;,&quot;of&quot;) ~ &quot;outfield&quot;,
                                     &quot;dh&quot; ~ &quot;dh&quot;,
                                     .default = &quot;infield&quot;)) %&gt;%
  ggplot(aes(x=position_group, y=salary_2022)) +
  geom_boxplot()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-6-3.png" width="90%" /></p>
<pre class="r"><code>salaries %&gt;%
  mutate(position_group = case_match(simple_position,
                                     c(&quot;rhp&quot;,&quot;lhp&quot;) ~ &quot;pitcher&quot;,
                                     c(&quot;cf&quot;,&quot;lf&quot;,&quot;rf&quot;,&quot;of&quot;) ~ &quot;outfield&quot;,
                                     &quot;dh&quot; ~ &quot;dh&quot;,
                                     .default = &quot;infield&quot;)) %&gt;%
  filter(service_time_floor&lt;=10) %&gt;%
  ggplot(aes(x=as.factor(service_time_floor),
             y=salary_2022, color=position_group)) +
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-6-4.png" width="90%" /></p>
<pre class="r"><code># playing a round with some idea, don&#39;t know if some of these are gonna be worth keeping</code></pre>
<div id="salaries-by-position-boxplots" class="section level3">
<h3>Salaries by Position Boxplots</h3>
<pre class="r"><code>salaries %&gt;%
  ggplot(aes(x = simple_position, y = salary_2022)) +
  geom_boxplot() +
  labs(title = &quot;Distribution of Salary by Position&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_x_discrete(guide = guide_axis(angle = 75), 
                  labels = c(&quot;1b&quot; = &quot;1st Base&quot;,
                    &quot;2b&quot; = &quot;2nd Base&quot;,
                    &quot;3b&quot; = &quot;3rd Base&quot;,
                    &quot;inf&quot; = &quot;Infield&quot;,
                    &quot;c&quot; = &quot;Catcher&quot;,
                    &quot;rf&quot; = &quot;Right Field&quot;,
                    &quot;lf&quot; = &quot;Left Field&quot;,
                    &quot;cf&quot; = &quot;Center Field&quot;,
                    &quot;of&quot; = &quot;Outfield&quot;,
                    &quot;lhp&quot; = &quot;Left Hand Pitcher&quot;,
                    &quot;rhp&quot; = &quot;Right Hand Pitcher&quot;,
                    &quot;dh&quot; = &quot;Designated Hitter&quot;,
                    &quot;ss&quot; = &quot;Shortstop&quot;)) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
<pre class="r"><code>salaries %&gt;%
  ggplot(aes(x = simple_position, y = service_time_floor)) +
  geom_boxplot() +
  labs(title = &quot;Distribution of Experience by Position&quot;,
       x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_x_discrete(guide = guide_axis(angle = 75), 
                  labels = c(&quot;1b&quot; = &quot;1st Base&quot;,
                    &quot;2b&quot; = &quot;2nd Base&quot;,
                    &quot;3b&quot; = &quot;3rd Base&quot;,
                    &quot;inf&quot; = &quot;Infield&quot;,
                    &quot;c&quot; = &quot;Catcher&quot;,
                    &quot;rf&quot; = &quot;Right Field&quot;,
                    &quot;lf&quot; = &quot;Left Field&quot;,
                    &quot;cf&quot; = &quot;Center Field&quot;,
                    &quot;of&quot; = &quot;Outfield&quot;,
                    &quot;lhp&quot; = &quot;Left Hand Pitcher&quot;,
                    &quot;rhp&quot; = &quot;Right Hand Pitcher&quot;,
                    &quot;dh&quot; = &quot;Designated Hitter&quot;,
                    &quot;ss&quot; = &quot;Shortstop&quot;)) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-7-2.png" width="90%" /></p>
<p>Infielders vs. outfielders vs. pitchers?</p>
<pre class="r"><code>salaries |&gt;
  mutate(position_group = case_match(simple_position,
                                     c(&quot;rhp&quot;,&quot;lhp&quot;) ~ &quot;pitcher&quot;,
                                     c(&quot;cf&quot;,&quot;lf&quot;,&quot;rf&quot;,&quot;of&quot;) ~ &quot;outfield&quot;,
                                     &quot;dh&quot; ~ &quot;dh&quot;,
                                     .default = &quot;infield&quot;)) |&gt;
  ggplot(aes(x = position_group, y = salary_2022)) +
  geom_boxplot()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-8-1.png" width="90%" /></p>
</div>
<div id="salaries-by-experience" class="section level3">
<h3>Salaries by Experience</h3>
<pre class="r"><code>salaries %&gt;%
  ggplot(aes(x = factor(service_time_floor), y = salary_2022)) +
  geom_boxplot() </code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-9-1.png" width="90%" /></p>
<pre class="r"><code>salaries %&gt;%
  group_by(service_time_floor) %&gt;%
  summarize(avg_salary = mean(salary_2022, na.rm = TRUE)) %&gt;%
  ggplot(aes(x = service_time_floor, y = avg_salary)) +
  geom_col() </code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-9-2.png" width="90%" /></p>
<pre class="r"><code>salaries |&gt;
  ggplot(aes(x = service_time_floor, y = salary_2022)) + 
  geom_point(alpha = 0.5) </code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-9-3.png" width="90%" /></p>
</div>
<div id="positions-by-experience" class="section level3">
<h3>Positions by Experience</h3>
<pre class="r"><code>salaries %&gt;%
  ggplot(aes(x=floor(service_time_yrs),fill = simple_position)) +
  geom_bar(position = &quot;fill&quot;) </code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-10-1.png" width="90%" /></p>
<pre class="r"><code>salaries |&gt;
  ggplot(aes(x = service_time_floor, 
             y = simple_position, 
             fill = simple_position)) + 
  ggridges::geom_density_ridges(alpha = 0.5) +
  labs(title = &quot;Experience by Position&quot;,
       x = &quot;Years of Experience&quot;,
       y = &quot;&quot;) +
  xlim(0,25) +
  scale_y_discrete(labels = c(&quot;1b&quot; = &quot;1st Base&quot;,
                    &quot;2b&quot; = &quot;2nd Base&quot;,
                    &quot;3b&quot; = &quot;3rd Base&quot;,
                    &quot;inf&quot; = &quot;Infield&quot;,
                    &quot;c&quot; = &quot;Catcher&quot;,
                    &quot;rf&quot; = &quot;Right Field&quot;,
                    &quot;lf&quot; = &quot;Left Field&quot;,
                    &quot;cf&quot; = &quot;Center Field&quot;,
                    &quot;of&quot; = &quot;Outfield&quot;,
                    &quot;lhp&quot; = &quot;Left Hand Pitcher&quot;,
                    &quot;rhp&quot; = &quot;Right Hand Pitcher&quot;,
                    &quot;dh&quot; = &quot;Designated Hitter&quot;,
                    &quot;ss&quot; = &quot;Shortstop&quot;)) +
  scale_fill_discrete(name = &quot;Position&quot;,
                      labels = c(&quot;1b&quot; = &quot;1st Base&quot;,
                    &quot;2b&quot; = &quot;2nd Base&quot;,
                    &quot;3b&quot; = &quot;3rd Base&quot;,
                    &quot;inf&quot; = &quot;Infield&quot;,
                    &quot;c&quot; = &quot;Catcher&quot;,
                    &quot;rf&quot; = &quot;Right Field&quot;,
                    &quot;lf&quot; = &quot;Left Field&quot;,
                    &quot;cf&quot; = &quot;Center Field&quot;,
                    &quot;of&quot; = &quot;Outfield&quot;,
                    &quot;lhp&quot; = &quot;Left Hand Pitcher&quot;,
                    &quot;rhp&quot; = &quot;Right Hand Pitcher&quot;,
                    &quot;dh&quot; = &quot;Designated Hitter&quot;,
                    &quot;ss&quot; = &quot;Shortstop&quot;)) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-10-2.png" width="90%" /></p>
</div>
<div id="salary-distribution-by-experience" class="section level3">
<h3>Salary Distribution by Experience</h3>
<pre class="r"><code>salaries %&gt;%
  ggplot(aes(x=factor(floor(service_time_yrs)), y=salary_2022)) +
  geom_boxplot() +
  labs(title = &quot;Salary Distribution for Years of Experience&quot;,
       x = &quot;Years of Experience&quot;,
       y = &quot;&quot;) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-11-1.png" width="90%" /></p>
</div>
</div>
<div id="batting-eda" class="section level2">
<h2>Batting EDA</h2>
<div id="distributions-of-variables" class="section level3">
<h3>Distributions of variables</h3>
<p>Looking at some hitting statistics</p>
<pre class="r"><code>merged_batting |&gt; 
  ggplot(aes(x = hr)) + 
  geom_histogram() +
  labs(title = &quot;Distribution of Home Runs&quot;,
    x = &quot;Home Run Total&quot;,
    y = &quot;Players&quot;)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-12-1.png" width="90%" /></p>
<pre class="r"><code>merged_batting |&gt; 
  ggplot(aes(x = rbi)) + 
  geom_histogram() +
  labs(x = &quot;Runs batted in (RBI)&quot;)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-12-2.png" width="90%" /></p>
<pre class="r"><code>merged_batting %&gt;%
  ggplot(aes(x = ab,y= hr)) +
  geom_point(aes(color = ops)) +
  geom_smooth(method = lm, se = FALSE, color = &quot;firebrick&quot;) +
  labs(title = &quot;Who is the most &#39;effective&#39; at the plate?&quot;,
       x = &quot;Chances at Bat&quot;,
       y = &quot;Number of Home Runs&quot;) +
  scale_color_continuous(&quot;OPS&quot;) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-12-3.png" width="90%" /></p>
<p>These are also right skewed so will need to normalize for any linear
model.</p>
<p>OPS is an “all in one” statistic combining on-base percentage (OBP)
and slugging (SLG).</p>
<p>OBP is calculated as <span class="math inline">\(\frac{Hits (H) +
Walks (BB) + Hit by pitch (HBP)}{At \ bats (AB) + Walks (BB) + sacrifice
\ flies (SF) + Hit by pitch (HBP)}\)</span></p>
<p>Slugging is calculated as <span class="math inline">\(\frac{total \
bases (TB)}{At \ bats (AB)}\)</span></p>
<p>OPS is the sum of these two statistics.</p>
<p>OPS+ (or adjusted OPS) is adjusted for the park and league
averages.</p>
<pre class="r"><code>merged_batting |&gt; 
  ggplot(aes(x = ops)) + 
  geom_histogram() +
  labs(x = &quot;OPS&quot;)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-13-1.png" width="90%" /></p>
<pre class="r"><code>merged_batting |&gt; 
  ggplot(aes(x = ops_2)) + 
  geom_histogram() +
  labs(x = &quot;OPS+&quot;)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-13-2.png" width="90%" /></p>
<p>One idea might be to compare OPS or OPS+ to more traditional
statistics, like RBIs, HRs, or batting averages to OPS or OPS+ as single
predictors of salary.</p>
<p>One other factor to consider is the correlation between some of these
variables</p>
<pre class="r"><code>merged_batting |&gt;
  select(hr, rbi, pa, ba, ops) |&gt;
  GGally::ggpairs()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-14-1.png" width="90%" /></p>
<p>Some of these potential predictors are fairly strongly correlated
(like RBI and HR, or BA and OPS), so it’s important not to include too
many collinear variables in a potential linear model.</p>
</div>
<div id="relationship-to-salary" class="section level3">
<h3>Relationship to salary</h3>
<p>Looking at some relationships to salary</p>
<p>Position vs. salary</p>
<pre class="r"><code>merged_batting |&gt;
  mutate(positions = str_split_i(position, &quot;-&quot;,1))  |&gt;
  ggplot(aes(x = positions,y= salary_2022)) +
  geom_boxplot()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-15-1.png" width="90%" /></p>
<pre class="r"><code>merged_batting |&gt;
  mutate(positions = str_split_i(position, &quot;-&quot;,1))  |&gt;
  group_by(positions) |&gt;
  summarize(avg_salary = mean(salary_2022, na.rm = TRUE),
            median_salary = median(salary_2022, na.rm = TRUE))</code></pre>
<pre><code>## # A tibble: 11 × 3
##    positions avg_salary median_salary
##    &lt;chr&gt;          &lt;dbl&gt;         &lt;dbl&gt;
##  1 1b          8845755.       6225000
##  2 2b          5010094.       2550000
##  3 3b          8302384.       3375000
##  4 c           3669983.       1750000
##  5 cf          8145270.       5500000
##  6 dh         11857143.      12000000
##  7 inf         1312500        1312500
##  8 lf          6971404.       6125000
##  9 of          2211196.        746100
## 10 rf          7833411.       4875000
## 11 ss          7266837        4000000</code></pre>
<p>HR vs. salary</p>
<pre class="r"><code>merged_batting |&gt;
  ggplot(aes(x = hr, y = salary_2022)) + 
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-16-1.png" width="90%" /></p>
<p>RBI vs. salary</p>
<pre class="r"><code>merged_batting |&gt;
  ggplot(aes(x = rbi, y = salary_2022)) + 
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-17-1.png" width="90%" /></p>
<p>BA vs. salary</p>
<pre class="r"><code>merged_batting |&gt;
  ggplot(aes(x = ba, y = salary_2022)) + 
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-18-1.png" width="90%" /></p>
<p>Plate appearances vs. salary</p>
<pre class="r"><code>merged_batting |&gt;
  ggplot(aes(x = pa, y = salary_2022)) + 
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-19-1.png" width="90%" /></p>
<p>OPS+ vs salary</p>
<pre class="r"><code>merged_batting |&gt;
  ggplot(aes(x = ops_2, y = salary_2022)) + 
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-20-1.png" width="90%" /></p>
<p>Some further ideas</p>
<pre class="r"><code>merged_batting %&gt;%
  ggplot(aes(x = salary_2022, y = hr)) +
  geom_point(data=transform(merged_batting, simple_position=NULL),
             color = &quot;grey&quot;, alpha = .5) +
  geom_point(color = &quot;firebrick&quot;) +
  facet_wrap(vars(simple_position)) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-21-1.png" width="90%" /></p>
<pre class="r"><code># could be interesting, not sure if worth pursuing

yrs = merged_batting |&gt;
  ggplot(aes(x = service_time_floor, y = salary_2022)) + 
  geom_point() +
  labs(x=&quot;Years of Experience&quot;,y=&quot;&quot;) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()
hrs = merged_batting |&gt;
  ggplot(aes(x = hr, y = salary_2022)) + 
  geom_point() +
  guides(y=&quot;none&quot;) +
  labs(x=&quot;Home Runs&quot;,y=&quot;&quot;) +
  theme_bw()
bas = merged_batting |&gt;
  ggplot(aes(x = ba, y = salary_2022)) + 
  geom_point() +
  labs(x=&quot;Batting Averages&quot;,y=&quot;&quot;) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()
ops = merged_batting |&gt;
  ggplot(aes(x = ops_2, y = salary_2022)) + 
  geom_point() +
  guides(y=&quot;none&quot;) +
  labs(x=&quot;OPS+&quot;,y=&quot;&quot;) +
  theme_bw()

scatter_patch = (yrs+hrs)/(bas+ops)

scatter_patch + plot_annotation(title = &quot;Scatterplot of Batting Statistics and Salary&quot;)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-21-2.png" width="90%" /></p>
<pre class="r"><code>yrsCol = merged_batting |&gt;
  count(service_time_floor) |&gt;
  ggplot(aes(x = service_time_floor, y=n)) + 
  geom_col() +
  labs(x=&quot;Years of Experience&quot;,y=&quot;&quot;) +
  theme_bw()
hrsHist = merged_batting |&gt;
  ggplot(aes(x = hr)) + 
  geom_histogram() +
  labs(x=&quot;Home Runs&quot;,y=&quot;&quot;) +
  theme_bw()
basHist = merged_batting |&gt;
  ggplot(aes(x = ba)) + 
  geom_histogram() +
  labs(x=&quot;Batting Averages&quot;,y=&quot;&quot;) +
  theme_bw()
opsHist = merged_batting |&gt;
  ggplot(aes(x = ops_2)) + 
  geom_histogram() +
  labs(x=&quot;OPS+&quot;,y=&quot;&quot;) +
  theme_bw()

dist_patch = (yrsCol+hrsHist)/(basHist+opsHist)
dist_patch + plot_annotation(title = &quot;Distribution of Important Batting Statistics&quot;)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-21-3.png" width="90%" /></p>
<p>Since salary (and other variables) are very skewed, we may want to
transform these data using a log transformation.</p>
</div>
<div id="regression-models" class="section level3">
<h3>Regression models</h3>
<p>Home runs</p>
<pre class="r"><code>hr_fit &lt;- lm(log10(salary_2022) ~ hr,
             data = merged_batting)

hr_fit |&gt;
  broom::tidy()</code></pre>
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   6.22     0.0445     140.   2.09e-310
## 2 hr            0.0206   0.00291      7.08 7.87e- 12</code></pre>
<p>OPS+</p>
<pre class="r"><code>ops_fit &lt;- lm(log10(salary_2022) ~ ops_2,
             data = merged_batting)

ops_fit |&gt;
  broom::tidy()</code></pre>
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)  5.96      0.100       59.4  1.38e-185
## 2 ops_2        0.00531   0.00100      5.28 2.22e-  7</code></pre>
<p>Would also want to account for years of experience in predicting
salary</p>
<pre class="r"><code>experience_fit &lt;- lm(log10(salary_2022) ~ service_time_floor,
                     data = merged_batting)

experience_fit |&gt;
  broom::tidy()</code></pre>
<pre><code>## # A tibble: 2 × 5
##   term               estimate std.error statistic  p.value
##   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)           5.98    0.0312      192.  0       
## 2 service_time_floor    0.115   0.00562      20.5 6.59e-62</code></pre>
<p>An interesting question might be: is OPS+ (an “all-in-one” statistic)
a better predictor of salary than traditional statistics?</p>
<p>To do this, I’m going to account for batting average, home runs per
plate appearance. I’m also going to adjust for service time for both
models, since that is strongly correlated with salary.</p>
<pre class="r"><code>hr_ba_fit &lt;- merged_batting |&gt;
  mutate(hr_per_pa = hr / pa) |&gt;
  lm(log10(salary_2022) ~ ba + hr_per_pa + service_time_floor,
                   data = _)

hr_ba_fit |&gt;
  broom::tidy()</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term               estimate std.error statistic   p.value
##   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)           5.33    0.134       39.9  2.22e-132
## 2 ba                    2.20    0.551        4.00 7.75e-  5
## 3 hr_per_pa             4.77    1.28         3.72 2.31e-  4
## 4 service_time_floor    0.113   0.00540     20.8  2.57e- 63</code></pre>
<pre class="r"><code>hr_ba_fit |&gt;
  broom::glance()</code></pre>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.585         0.581 0.361      164. 1.64e-66     3  -139.  288.  308.
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<pre class="r"><code>plot(hr_ba_fit, which = 1)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-25-1.png" width="90%" /></p>
<pre class="r"><code>plot(hr_ba_fit, which = 2)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-25-2.png" width="90%" /></p>
<pre class="r"><code>ops_fit &lt;- merged_batting |&gt;
  lm(log10(salary_2022) ~ ops_2 + service_time_floor,
                   data = _)

ops_fit |&gt;
  broom::tidy()</code></pre>
<pre><code>## # A tibble: 3 × 5
##   term               estimate std.error statistic   p.value
##   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)         5.55     0.0689       80.6  1.69e-228
## 2 ops_2               0.00455  0.000664      6.85 3.38e- 11
## 3 service_time_floor  0.113    0.00529      21.4  1.75e- 65</code></pre>
<pre class="r"><code>ops_fit |&gt;
  broom::glance()</code></pre>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.597         0.595 0.355      260. 4.72e-70     2  -134.  276.  291.
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<pre class="r"><code>plot(ops_fit, which = 1)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-26-1.png" width="90%" /></p>
<pre class="r"><code>plot(ops_fit, which = 2)</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-26-2.png" width="90%" /></p>
<p>Based on these statistics, the model with than OPS+ is a better
predictor than the one with home runs and batting average, which makes
sense since OPS+ is internally accounting for more other factors.</p>
<p>Which players provided the best value for money?</p>
<pre class="r"><code>merged_batting |&gt;
  modelr::add_predictions(ops_fit) |&gt;
  modelr::add_residuals(ops_fit) |&gt;
  arrange(resid) |&gt;
  select(name, salary_2022, service_time_floor, ops_2, pred, resid ) |&gt;
  mutate(expected_salary = 10^pred) |&gt;
  slice(1:10)</code></pre>
<pre><code>## # A tibble: 10 × 7
##    name        salary_2022 service_time_floor ops_2  pred  resid expected_salary
##    &lt;chr&gt;             &lt;dbl&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;           &lt;dbl&gt;
##  1 Albert Puj…     2500000                 21   151  8.61 -2.22       410735252.
##  2 Jed Lowrie       850000                 13    50  7.25 -1.32        17780138.
##  3 Kurt Suzuki     1750000                 14    59  7.40 -1.16        25346063.
##  4 Alcides Es…     1000000                 10    58  6.95 -0.947        8853328.
##  5 Robinson C…      900000                  9    60  6.84 -0.889        6968403.
##  6 Marwin Gon…     1100000                  9    64  6.86 -0.820        7266342.
##  7 Stephen Vo…      850000                  8    64  6.75 -0.819        5600815.
##  8 Yordan Alv…      764600                  2   188  6.63 -0.750        4300548.
##  9 Brandon Dr…      900000                  5   122  6.67 -0.718        4706575.
## 10 Yadier Mol…    10000000                 17    52  7.71 -0.711       51438079.</code></pre>
<p>The most cost-effective players were those who</p>
<ul>
<li><p>Played well (high OPS+) but had low salaries.</p></li>
<li><p>Played poorly and had a lot of experience, but had low
salaries.</p></li>
</ul>
</div>
</div>
<div id="pitching-eda" class="section level2">
<h2>Pitching EDA</h2>
<p>In order to eliminate pitchers with very few appearances or position
players (catchers, first basemen, etc.) who came in to pitch in
blowouts, I filtered only for pitchers with at least 10 innings
pitches.</p>
<div id="distribution-of-innings-pitched" class="section level3">
<h3>Distribution of Innings Pitched</h3>
<pre class="r"><code>merged_pitching |&gt; 
  ggplot(aes(x = ip_total)) + 
  geom_histogram(binwidth = 5, fill = &quot;red&quot;, col = &quot;black&quot;) +
  labs(title = &quot;Distribution of Innings Pitched, MLB Pitchers, 2022&quot;,
       x = &quot;Innings Pitched&quot;,
       y = &quot;Pitcher Count&quot;) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-28-1.png" width="90%" /></p>
</div>
<div id="distribution-of-era" class="section level3">
<h3>Distribution of ERA+</h3>
<pre class="r"><code>merged_pitching |&gt;
  ggplot(aes(x = era_2)) + 
  geom_histogram(fill = &quot;lightblue&quot;, col = &quot;black&quot;) +
    labs(title = &quot;Distribution of ERA+, MLB Pitchers, 2022&quot;,
       x = &quot;ERA+&quot;,
       y = &quot;&quot;) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-29-1.png" width="90%" /></p>
</div>
<div id="ip-vs.-salary-plot" class="section level3">
<h3>IP vs. Salary Plot</h3>
<pre class="r"><code>merged_pitching |&gt; 
  ggplot(aes(x = ip_total, y = salary_2022)) + 
  geom_point() + 
  scale_x_continuous(lim = c(0, 250)) +
  scale_y_continuous(labels = label_comma()) +
  labs(title = &quot;Innings Pitched by 2022 Salary&quot;,
       x = &quot;Innings Pitched&quot;,
       y = &quot;&quot;) +
  theme_bw()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-30-1.png" width="90%" /></p>
</div>
<div id="era-vs.-salary-plot" class="section level3">
<h3>ERA+ vs. Salary Plot</h3>
<pre class="r"><code>merged_pitching |&gt; 
  ggplot(aes(x = era_2, y = salary_2022)) + 
  geom_point() +
  scale_x_continuous(lim = c(0, 400))</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-31-1.png" width="90%" /></p>
</div>
<div id="ip-vs.-log-salary-plot" class="section level3">
<h3>IP vs. Log Salary Plot</h3>
<pre class="r"><code>merged_pitching |&gt; 
  ggplot(aes(x = ip_total, y = log(salary_2022))) + 
  geom_point() + 
  scale_x_continuous(lim = c(0, 400))</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-32-1.png" width="90%" /></p>
</div>
<div id="era-vs.-log-salary-plot" class="section level3">
<h3>ERA+ vs. Log Salary Plot</h3>
<pre class="r"><code>merged_pitching |&gt; 
  ggplot(aes(x = era_2, y = log(salary_2022))) + 
  geom_point() + 
  scale_x_continuous(lim = c(0, 400))</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-33-1.png" width="90%" /></p>
</div>
<div id="lms" class="section level3">
<h3>LMs</h3>
<pre class="r"><code>lm_ip = lm(salary_2022 ~ ip_total, data = merged_pitching)
summary(lm_ip)</code></pre>
<pre><code>## 
## Call:
## lm(formula = salary_2022 ~ ip_total, data = merged_pitching)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -7881584 -2346730 -1339157   542534 36868673 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   453710     505732   0.897     0.37    
## ip_total       41360       5280   7.833    4e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5394000 on 417 degrees of freedom
##   (50 observations deleted due to missingness)
## Multiple R-squared:  0.1283, Adjusted R-squared:  0.1262 
## F-statistic: 61.35 on 1 and 417 DF,  p-value: 4.002e-14</code></pre>
<pre class="r"><code>lm_ip_data = tibble(fitted.values(lm_ip), residuals(lm_ip))

names(lm_ip_data) = c(&quot;fitted&quot;, &quot;resid&quot;)

lm_ip_data |&gt;
  ggplot(aes(x = fitted, y = resid)) +
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-34-1.png" width="90%" /></p>
<pre class="r"><code>view(lm_ip_data)</code></pre>
<pre class="r"><code>lm_era_2 = lm(salary_2022 ~ era_2, data = merged_pitching)
summary(lm_era_2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = salary_2022 ~ era_2, data = merged_pitching)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -4017039 -3088950 -2721275   385077 39372391 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3560272     674783   5.276 2.12e-07 ***
## era_2           2371       5297   0.448    0.655    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5776000 on 417 degrees of freedom
##   (50 observations deleted due to missingness)
## Multiple R-squared:  0.0004801,  Adjusted R-squared:  -0.001917 
## F-statistic: 0.2003 on 1 and 417 DF,  p-value: 0.6547</code></pre>
<pre class="r"><code>lm_era_2_data = tibble(fitted.values(lm_era_2), residuals(lm_era_2))

names(lm_era_2_data) = c(&quot;fitted&quot;, &quot;resid&quot;)

lm_era_2_data |&gt;
  ggplot(aes(x = fitted, y = resid)) +
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-35-1.png" width="90%" /></p>
<pre class="r"><code>view(lm_era_2_data)</code></pre>
</div>
<div id="log-transformed-lms" class="section level3">
<h3>Log-Transformed LMs</h3>
<pre class="r"><code>lm_ip_log = lm(log(salary_2022) ~ ip_total, data = merged_pitching)
summary(lm_ip_log)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(salary_2022) ~ ip_total, data = merged_pitching)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.8882 -0.7565 -0.4034  0.7288  3.1811 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 13.776177   0.097656 141.069  &lt; 2e-16 ***
## ip_total     0.008032   0.001020   7.877 2.93e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.042 on 417 degrees of freedom
##   (50 observations deleted due to missingness)
## Multiple R-squared:  0.1295, Adjusted R-squared:  0.1274 
## F-statistic: 62.05 on 1 and 417 DF,  p-value: 2.933e-14</code></pre>
<pre class="r"><code>lm_ip_log_data = tibble(fitted.values(lm_ip_log), residuals(lm_ip_log))

names(lm_ip_log_data) = c(&quot;fitted&quot;, &quot;resid&quot;)

lm_ip_log_data |&gt;
  ggplot(aes(x = fitted, y = resid)) +
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-36-1.png" width="90%" /></p>
<pre class="r"><code>view(lm_ip_log_data)</code></pre>
<pre class="r"><code>lm_era_2_log = lm(log(salary_2022) ~ era_2, data = merged_pitching)
summary(lm_era_2_log)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(salary_2022) ~ era_2, data = merged_pitching)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9979 -0.9559 -0.5614  0.8333  3.1417 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.441e+01  1.304e-01 110.497   &lt;2e-16 ***
## era_2       1.869e-04  1.024e-03   0.183    0.855    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.116 on 417 degrees of freedom
##   (50 observations deleted due to missingness)
## Multiple R-squared:  7.994e-05,  Adjusted R-squared:  -0.002318 
## F-statistic: 0.03334 on 1 and 417 DF,  p-value: 0.8552</code></pre>
<pre class="r"><code>lm_era_2_data_log = tibble(fitted.values(lm_era_2_log), residuals(lm_era_2_log))

names(lm_era_2_data_log) = c(&quot;fitted&quot;, &quot;resid&quot;)

lm_era_2_data_log |&gt;
  ggplot(aes(x = fitted, y = resid)) +
  geom_point()</code></pre>
<p><img src="preliminary_analysis_files/figure-html/unnamed-chunk-37-1.png" width="90%" /></p>
</div>
<div id="final-pitching-lm" class="section level3">
<h3>Final Pitching LM</h3>
<pre class="r"><code>lm_pitching = lm(salary_2022 ~ hand + pitcher_type + hand*pitcher_type + ip_total + era_2,
                 data = merged_pitching)

summary(lm_pitching)</code></pre>
<pre><code>## 
## Call:
## lm(formula = salary_2022 ~ hand + pitcher_type + hand * pitcher_type + 
##     ip_total + era_2, data = merged_pitching)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -9175137 -1716370  -699492   602203 35065484 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)            15005127    4956120   3.028  0.00262 **
## handrhp                -8606379    5351662  -1.608  0.10857   
## pitcher_typer         -14812000    4970647  -2.980  0.00305 **
## pitcher_types          -8591542    5028351  -1.709  0.08828 . 
## ip_total                  16873       5758   2.930  0.00357 **
## era_2                      4389       4639   0.946  0.34466   
## handrhp:pitcher_typer   8656223    5386994   1.607  0.10885   
## handrhp:pitcher_types   7266736    5438133   1.336  0.18221   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4937000 on 411 degrees of freedom
##   (50 observations deleted due to missingness)
## Multiple R-squared:  0.2803, Adjusted R-squared:  0.268 
## F-statistic: 22.87 on 7 and 411 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>From our model, we can see that relief pitchers have significantly
lower salaries than closing pitchers, which makes sense, since closing
pitchers have very strong reputations as some of the most effective
pitchers in the game and therefore will draw high salaries.
Additionally, the <code>era_2</code> predictor, even when accounting for
pitcher handedness, pitcher type, and the number of innings pitched, has
an insignificant <span class="math inline">\(P\)</span>-value, implying
that there is no significant association between one of the most highly
regarded summative statistics for pitching effectiveness and pitcher
salary.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
