<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Cameron Chesbrough" />

<meta name="date" content="2024-11-07" />

<title>Final_Report_Draft</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Final_Report_Draft.html">Report</a>
</li>
<li>
  <a href="preliminary_analysis.html">EDA</a>
</li>
<li>
  <a href="conclusion.html">Conclusion</a>
</li>
<li>
  <a href="about_us.html">About the Group</a>
</li>
<li>
  <a href="https://github.com/jl7033/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Final_Report_Draft</h1>
<h4 class="author">Cameron Chesbrough</h4>
<h4 class="date">2024-11-07</h4>

</div>


<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>MLB player salaries are growing faster than ever. In 2001, former
Seattle Mariners superstar Alex Rodriguez signed a 10-year, $252 million
deal that broke the record for the most lucrative contract in
professional sports history. And yet, Rodriguez’s deal pales in
comparison to the monster contract that current superstar Juan Soto is
expected to sign within the next week, which is projected to go for at
least 12 years and $600 million. The skyrocketing salaries don’t just
apply to the game’s most marquee names; since 2003, the average player
salary has more than doubled, from $2.37 million to $4.98 million for
the 2024 season (source: <a
href="https://www.statista.com/statistics/236213/mean-salaray-of-players-in-majpr-league-baseball/"
class="uri">https://www.statista.com/statistics/236213/mean-salaray-of-players-in-majpr-league-baseball/</a>).
As players become more and more expensive,</p>
<p>The primary goal of our project is to determine whether baseball
players – both batters and pitchers – are worth their salaries, and
whether teams should focus primarily on signing big-money free agents or
taking a more egalitarian and young player-heavy approach. More
specifically, are advanced statistics such as OPS+ (for hitters) and
ERA+ (for pitchers) significantly associated with player salary? Our
conclusions could give MLB teams insight into how they can build their
rosters to optimize their chances of making the postseason and
ultimately winning the World Series.</p>
</div>
<div id="related-work" class="section level1">
<h1>Related work</h1>
<p>There has been a heated debate over the use of statistics and
analytics in the evaluation of player performances and whether the
decision to pay players can be aided by these methods. Sabermetrics (add
hyperlink in website) is one of the more popular ways of applying
statistics to baseball to be an addition to traditional evaluations. The
famous movie Moneyball (add hyperlink in website) tells the story of the
Oakland Athletic’s, an underdog using statistics over traditional
evaluations to gain an edge. One of the hopes of our project is to
approach some of these same problems from our own perspective.</p>
</div>
<div id="initial-questions" class="section level1">
<h1>Initial questions</h1>
<p>Before beginning the project, we set out to potentially answer three
primary questions:</p>
<ol style="list-style-type: decimal">
<li><p>What collected statistics are most correlated with salary? Are
advanced statistics such as ERA closer than simple counts such as
strikeouts?</p></li>
<li><p>Are GMs good at deciding who to give contracts? That is, do the
players with the highest salaries have the best performance
metrics?</p></li>
<li><p>Can we predict the salary of a player with a model built from
their 2022 statistics?</p></li>
</ol>
<p>After conducting an exploratory data analysis, we adjusted our
questions into:</p>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<div id="data-cleaning-code" class="section level2">
<h2>Data Cleaning Code</h2>
<div id="setup" class="section level3">
<h3>Setup</h3>
</div>
<div id="salary-data" class="section level3">
<h3>Salary Data</h3>
<pre class="r"><code>salaries = read_excel(
  &quot;data/MLB-Salaries 2000-24.xlsx&quot;, 
  sheet = &quot;2022.xls&quot;,
  skip = 1) |&gt;
  select(1:4) |&gt;
  rename(position = &quot;Pos&#39;n&quot;,
         salary_2022 = &quot;2022.0&quot;,
         service_time_yrs = &quot;MLS&quot;,
         name = &quot;Player&quot;) %&gt;%
  mutate(name = str_split(name, &quot;,&quot;),
         name = map(name, rev),       
         name = map_chr(name, str_c, collapse = &quot; &quot;),
         name = str_trim(name),
         name = str_replace_all(name, &quot;[*#\\.,]&quot;, &quot;&quot;),
         junior = str_detect(name, &quot;Jr&quot;),
         name = if_else(junior == TRUE, str_remove(name, &quot; Jr&quot;), name),
         name = if_else(junior == TRUE, str_c(name, &quot; Jr&quot;), name),
         name = stringi::stri_trans_general(name,id = &quot;Latin-ASCII&quot;)) |&gt;
  select(-junior) %&gt;%
  mutate(simple_position = str_split_i(position, &quot;-&quot;, 1),
         simple_position = fct_relevel(simple_position,
                                       c(&quot;c&quot;, &quot;1b&quot;, &quot;2b&quot;, &quot;3b&quot;, &quot;ss&quot;,
                                         &quot;lf&quot;, &quot;cf&quot;, &quot;rf&quot;, &quot;inf&quot;, &quot;of&quot;,
                                         &quot;dh&quot;, &quot;rhp&quot;, &quot;lhp&quot;)),
         service_time_floor = floor(service_time_yrs))</code></pre>
</div>
<div id="batting-data" class="section level3">
<h3>Batting Data</h3>
<pre class="r"><code>batting = read_delim(&quot;data/2022 MLB Player Stats - Batting.csv&quot;, delim = &quot;;&quot;,
                     locale = locale(encoding = &quot;latin1&quot;)) |&gt;
  janitor::clean_names() %&gt;%
  group_by(name) |&gt;
  mutate(name_count = n(),
         keep_row = case_when(name_count == 1 ~ TRUE,
                              name_count &gt; 1 &amp; tm == &quot;TOT&quot; ~ TRUE,
                              .default = FALSE)) |&gt;
  filter(keep_row == TRUE) %&gt;%
  mutate(name_count = n(),
         keep_row = case_when(name_count == 1 ~ TRUE,
                              name_count &gt; 1 &amp; lg == &quot;MLB&quot; ~ TRUE,
                              .default = FALSE)) |&gt;
  ungroup() |&gt;
  filter(keep_row == TRUE) %&gt;%
  mutate(name = str_split(name, &quot;\\s+&quot;),
         name = map_chr(name, str_c, collapse = &quot; &quot;),
         name = str_trim(name),
         name = str_replace_all(name, &quot;[*#\\.]&quot;, &quot;&quot;),
         name = stringi::stri_trans_general(name,id = &quot;Latin-ASCII&quot;))

merged_batting &lt;- salaries |&gt;
  mutate(simple_position = str_split_i(position, &quot;-&quot;, 1)) |&gt;
  filter(!simple_position %in% c(&quot;rhp&quot;,&quot;lhp&quot;)) |&gt;
  inner_join(batting, by = &quot;name&quot;) |&gt;
  filter(pa &gt;= 100)

salary_not_in_batting &lt;- anti_join(salaries, batting, by = &quot;name&quot;)
batting_not_in_salary &lt;- anti_join(batting, salaries, by = &quot;name&quot;)</code></pre>
</div>
<div id="pitching-data" class="section level3">
<h3>Pitching Data</h3>
<p>(same data cleaning process as above)</p>
<pre class="r"><code>pitching = read_delim(&quot;data/2022 MLB Player Stats - Pitching.csv&quot;, delim = &quot;;&quot;,
                     locale = locale(encoding = &quot;latin1&quot;)) |&gt;
  janitor::clean_names() %&gt;%
  group_by(name) |&gt;
  mutate(name_count = n(),
         keep_row = case_when(name_count == 1 ~ TRUE,
                              name_count &gt; 1 &amp; tm == &quot;TOT&quot; ~ TRUE,
                              .default = FALSE)) |&gt;
  filter(keep_row == TRUE) %&gt;%
  mutate(name_count = n(),
         keep_row = case_when(name_count == 1 ~ TRUE,
                              name_count &gt; 1 &amp; lg == &quot;MLB&quot; ~ TRUE,
                              .default = FALSE)) |&gt;
  ungroup() |&gt;
  filter(keep_row == TRUE) %&gt;%
  mutate(name = str_split(name, &quot;\\s+&quot;),
         name = map_chr(name, str_c, collapse = &quot; &quot;),
         name = str_trim(name),
         name = str_replace_all(name, &quot;[*#\\.]&quot;, &quot;&quot;),
         name = stringi::stri_trans_general(name,id = &quot;Latin-ASCII&quot;))

merged_pitching &lt;- inner_join(salaries, pitching, by = &quot;name&quot;) |&gt;
  filter(ip &gt;= 20) |&gt;
  separate(ip, into = c(&quot;ip&quot;, &quot;ip_dec&quot;), remove = FALSE, convert = TRUE) |&gt;
  mutate(ip_dec_333 = ifelse(is.na(ip_dec), 0, ip_dec * 333)  ,
         ip_total = paste(ip, ip_dec_333, sep = &quot;.&quot;),
         ip_total = as.numeric(ip_total)) |&gt;
  select(-ip, -ip_dec, -ip_dec_333) |&gt;
  separate(position, into = c(&quot;hand&quot;, &quot;pitcher_type&quot;)) |&gt;
  mutate(pitcher_type = ifelse(is.na(pitcher_type), &quot;r&quot;, pitcher_type)) |&gt;
  filter(hand == &quot;lhp&quot; | hand == &quot;rhp&quot;)

salary_not_in_pitching &lt;- anti_join(salaries, pitching, by = &quot;name&quot;)
pitching_not_in_salary &lt;- anti_join(pitching, salaries, by = &quot;name&quot;)</code></pre>
</div>
</div>
</div>
<div id="exploratory-analysis" class="section level1">
<h1>Exploratory analysis</h1>
<p>Our exploratory data analysis can be grouped into three categories:
salary, batting, and pitching.</p>
<p>Player salaries were highly right-skewed. This was expected, as many
players make the league minimum salary of 700,000. The one position
group not so heavily right skewed are the Designated Hitters. Similarly,
the Designated Hitters had a higher average years of experience.
Intuitively this makes sense as teams will want to select the better
players for the position. Overall, most players were in their first year
of the MLB with 68.2% having 5 or less years of experience. Players with
more years of experience seem to get higher salaries, increasing as
their years of experience.</p>
<pre class="r"><code># Salary by Posiition Group
salaries |&gt;
  mutate(position_group = case_match(simple_position,
                                     c(&quot;rhp&quot;,&quot;lhp&quot;) ~ &quot;pitcher&quot;,
                                     c(&quot;cf&quot;,&quot;lf&quot;,&quot;rf&quot;,&quot;of&quot;) ~ &quot;outfield&quot;,
                                     &quot;dh&quot; ~ &quot;dh&quot;,
                                     .default = &quot;infield&quot;)) |&gt;
  ggplot(aes(x = salary_2022, color = position_group)) +
  geom_density() +
  labs(title = &quot;Salary by Position Group&quot;,
       x = &quot;2022 Salary&quot;,
       y = &quot;&quot;) +
  scale_x_continuous(labels = label_comma()) +
  scale_color_discrete(name = &quot;Position Group&quot;,
                       labels = c(&quot;Designated Hitter&quot;,
                                &quot;Infield&quot;,
                                &quot;Outfield&quot;,
                                &quot;Pitcher&quot;)) +
  theme_bw()</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-4-1.png" width="90%" /></p>
<pre class="r"><code># Salary by Experience
salaries %&gt;%
  ggplot(aes(x=factor(floor(service_time_yrs)), y=salary_2022)) +
  geom_boxplot() +
  labs(title = &quot;Salary Distribution for Years of Experience&quot;,
       x = &quot;Years of Experience&quot;,
       y = &quot;&quot;) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-4-2.png" width="90%" /></p>
<pre class="r"><code># Experience by Position
salaries |&gt;
  ggplot(aes(x = service_time_floor, 
             y = simple_position, 
             fill = simple_position)) + 
  ggridges::geom_density_ridges(alpha = 0.5) +
  labs(title = &quot;Experience by Position&quot;,
       x = &quot;Years of Experience&quot;,
       y = &quot;&quot;) +
  xlim(0,25) +
  scale_y_discrete(labels = c(&quot;1b&quot; = &quot;1st Base&quot;,
                    &quot;2b&quot; = &quot;2nd Base&quot;,
                    &quot;3b&quot; = &quot;3rd Base&quot;,
                    &quot;inf&quot; = &quot;Infield&quot;,
                    &quot;c&quot; = &quot;Catcher&quot;,
                    &quot;rf&quot; = &quot;Right Field&quot;,
                    &quot;lf&quot; = &quot;Left Field&quot;,
                    &quot;cf&quot; = &quot;Center Field&quot;,
                    &quot;of&quot; = &quot;Outfield&quot;,
                    &quot;lhp&quot; = &quot;Left Hand Pitcher&quot;,
                    &quot;rhp&quot; = &quot;Right Hand Pitcher&quot;,
                    &quot;dh&quot; = &quot;Designated Hitter&quot;,
                    &quot;ss&quot; = &quot;Shortstop&quot;)) +
  scale_fill_discrete(name = &quot;Position&quot;,
                      labels = c(&quot;1b&quot; = &quot;1st Base&quot;,
                    &quot;2b&quot; = &quot;2nd Base&quot;,
                    &quot;3b&quot; = &quot;3rd Base&quot;,
                    &quot;inf&quot; = &quot;Infield&quot;,
                    &quot;c&quot; = &quot;Catcher&quot;,
                    &quot;rf&quot; = &quot;Right Field&quot;,
                    &quot;lf&quot; = &quot;Left Field&quot;,
                    &quot;cf&quot; = &quot;Center Field&quot;,
                    &quot;of&quot; = &quot;Outfield&quot;,
                    &quot;lhp&quot; = &quot;Left Hand Pitcher&quot;,
                    &quot;rhp&quot; = &quot;Right Hand Pitcher&quot;,
                    &quot;dh&quot; = &quot;Designated Hitter&quot;,
                    &quot;ss&quot; = &quot;Shortstop&quot;)) +
  theme_bw()</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-4-3.png" width="90%" /></p>
<p>Many of the counting statistics for batting are right skewed, as most
players are not hitting multiple home runs in the season. Some of the
advanced statistics such as OPS+ are more normally distributed. An
important idea to keep in mind is that many of these collected
statistics are strongly correlated with each other as the advanced
statistics are often a formula taking input from the counting
statistics. Looking at the relation with salary, it seems that there may
be an association between salary and home runs as well as OPS+.</p>
<pre class="r"><code># Chances at Bat by Home Runs
merged_batting %&gt;%
  ggplot(aes(x = ab,y= hr)) +
  geom_point(aes(color = ops)) +
  geom_smooth(method = lm, se = FALSE, color = &quot;firebrick&quot;) +
  labs(title = &quot;Who is the most &#39;effective&#39; at the plate?&quot;,
       x = &quot;Chances at Bat&quot;,
       y = &quot;Number of Home Runs&quot;) +
  scale_color_continuous(&quot;OPS&quot;) +
  theme_bw()</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<pre class="r"><code># Corrs for Batting Data
merged_batting |&gt;
  select(hr, ba, ops) |&gt;
  GGally::ggpairs()</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-5-2.png" width="90%" /></p>
<pre class="r"><code># Scatter for Used Statistics
yrs = merged_batting |&gt;
  ggplot(aes(x = service_time_floor, y = salary_2022)) + 
  geom_point() +
  labs(x=&quot;Years of Experience&quot;,y=&quot;&quot;) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()
hrs = merged_batting |&gt;
  ggplot(aes(x = hr, y = salary_2022)) + 
  geom_point() +
  guides(y=&quot;none&quot;) +
  labs(x=&quot;Home Runs&quot;,y=&quot;&quot;) +
  theme_bw()
bas = merged_batting |&gt;
  ggplot(aes(x = ba, y = salary_2022)) + 
  geom_point() +
  labs(x=&quot;Batting Averages&quot;,y=&quot;&quot;) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()
ops = merged_batting |&gt;
  ggplot(aes(x = ops_2, y = salary_2022)) + 
  geom_point() +
  guides(y=&quot;none&quot;) +
  labs(x=&quot;OPS+&quot;,y=&quot;&quot;) +
  theme_bw()

scatter_patch = (yrs+hrs)/(bas+ops)

scatter_patch + plot_annotation(title = &quot;Scatterplot of Batting Statistics and Salary&quot;)</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-5-3.png" width="90%" /></p>
<pre class="r"><code># Distributions for Used Statistics
yrsCol = merged_batting |&gt;
  count(service_time_floor) |&gt;
  ggplot(aes(x = service_time_floor, y=n)) + 
  geom_col() +
  labs(x=&quot;Years of Experience&quot;,y=&quot;&quot;) +
  theme_bw()
hrsHist = merged_batting |&gt;
  ggplot(aes(x = hr)) + 
  geom_histogram() +
  labs(x=&quot;Home Runs&quot;,y=&quot;&quot;) +
  theme_bw()
basHist = merged_batting |&gt;
  ggplot(aes(x = ba)) + 
  geom_histogram() +
  labs(x=&quot;Batting Averages&quot;,y=&quot;&quot;) +
  theme_bw()
opsHist = merged_batting |&gt;
  ggplot(aes(x = ops_2)) + 
  geom_histogram() +
  labs(x=&quot;OPS+&quot;,y=&quot;&quot;) +
  theme_bw()

dist_patch = (yrsCol+hrsHist)/(basHist+opsHist)

dist_patch + plot_annotation(title = &quot;Distribution of Important Batting Statistics&quot;)</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-5-4.png" width="90%" /></p>
<div id="pitching-eda" class="section level2">
<h2>Pitching EDA</h2>
<pre class="r"><code>ip_plot = merged_pitching |&gt; 
  ggplot(aes(x = ip_total)) + 
  geom_histogram(binwidth = 5, fill = &quot;red&quot;, col = &quot;black&quot;) +
  labs(
       x = &quot;Innings Pitched&quot;,
       y = &quot;Pitcher Count&quot;) +
  theme_bw()

era_plot = merged_pitching |&gt;
  ggplot(aes(x = era_2)) + 
  geom_histogram(fill = &quot;lightblue&quot;, col = &quot;black&quot;) +
    labs(
       x = &quot;ERA+&quot;,
       y = &quot;Pitcher Count&quot;) +
  theme_bw()

bb_plot = merged_pitching |&gt;
  ggplot(aes(x = bb9)) + 
  geom_histogram(fill = &quot;darkgreen&quot;, col = &quot;black&quot;) +
    labs(
       x = &quot;Walks per 9 Innings (BB/9)&quot;,
       y = &quot;Pitcher Count&quot;) +
  theme_bw()

so_plot = merged_pitching |&gt;
  ggplot(aes(x = so9)) + 
  geom_histogram(fill = &quot;orange&quot;, col = &quot;black&quot;) +
    labs(
       x = &quot;Strikeouts per 9 Innings (SO/9)&quot;,
       y = &quot;Pitcher Count&quot;) +
  theme_bw()

hist_pitch = (ip_plot + era_plot) / (bb_plot + so_plot)
hist_pitch + plot_annotation(title = &quot;Histograms of Pitching Statistics&quot;)</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<p>The distribution of innings pitched is quite right-skewed, with a
peak around 70 innings pitched. The distribution of ERA+ is right-skewed
as well, with a peak around 100 (the league average) and a small number
of pitchers with an ERA+ above 200. The distributions of BB/9 and SO/9
are mostly symmetric, with peaks around 3 and 9, respectively.</p>
<pre class="r"><code>ip_sal = merged_pitching |&gt; 
  ggplot(aes(x = ip_total, y = salary_2022)) + 
  geom_point(col = &quot;red&quot;) + 
  scale_x_continuous(lim = c(0, 250)) +
  scale_y_continuous(labels = label_comma()) +
  labs(x = &quot;Innings Pitched&quot;,
       y = &quot;2022 Salary&quot;) +
  theme_bw()

era_sal = merged_pitching |&gt; 
  ggplot(aes(x = era_2, y = salary_2022)) + 
  geom_point(col = &quot;lightblue&quot;) +
  scale_x_continuous(lim = c(0, 400)) + 
  scale_y_continuous(labels = label_comma()) +
  labs(x = &quot;ERA+&quot;,
       y = &quot;2022 Salary&quot;) +
  theme_bw()

bb_sal = merged_pitching |&gt; 
  ggplot(aes(x = bb9, y = salary_2022)) + 
  geom_point(col = &quot;darkgreen&quot;) +
  scale_x_continuous(lim = c(0, 10)) + 
  scale_y_continuous(labels = label_comma()) +
   labs(x = &quot;Walks per 9 Innings (BB/9)&quot;,
       y = &quot;2022 Salary&quot;) +
  theme_bw()

so_sal = merged_pitching |&gt; 
  ggplot(aes(x = so9, y = salary_2022)) + 
  geom_point(col = &quot;orange&quot;) +
  scale_x_continuous(lim = c(0, 20)) + 
  scale_y_continuous(labels = label_comma()) +
   labs(x = &quot;Strikeouts Per 9 Innings (SO/9)&quot;,
       y = &quot;2022 Salary&quot;) +
  theme_bw()

scatt_pitch = (ip_sal + era_sal) / (bb_sal + so_sal)
scatt_pitch + plot_annotation(title = &quot;Scatterplots of Pitching Statistics vs. Salary&quot;)</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
<p>Interestingly, the pitchers with the highest ERA+ often had
considerably lower salaries.</p>
</div>
</div>
<div id="additional-analysis" class="section level1">
<h1>Additional analysis</h1>
<div id="batting-model" class="section level2">
<h2>Batting Model</h2>
</div>
<div id="pitching-model" class="section level2">
<h2>Pitching Model</h2>
<pre class="r"><code>lm_pitching = lm(log10(salary_2022) ~ hand + pitcher_type + hand*pitcher_type + ip_total + era_2 + bb9 + so9,
                 data = merged_pitching)

summary(lm_pitching)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log10(salary_2022) ~ hand + pitcher_type + hand * 
##     pitcher_type + ip_total + era_2 + bb9 + so9, data = merged_pitching)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9091 -0.2543 -0.1055  0.2800  1.0887 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            7.1698385  0.4263438  16.817  &lt; 2e-16 ***
## handrhp               -0.5627367  0.4323993  -1.301 0.193844    
## pitcher_typer         -1.2404041  0.4012211  -3.092 0.002127 ** 
## pitcher_types         -0.6852709  0.4060161  -1.688 0.092213 .  
## ip_total               0.0008592  0.0004851   1.771 0.077299 .  
## era_2                 -0.0004753  0.0004075  -1.167 0.244057    
## bb9                   -0.0491949  0.0181176  -2.715 0.006902 ** 
## so9                    0.0358753  0.0102973   3.484 0.000547 ***
## handrhp:pitcher_typer  0.5681287  0.4349509   1.306 0.192222    
## handrhp:pitcher_types  0.4854323  0.4390664   1.106 0.269549    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3945 on 409 degrees of freedom
##   (50 observations deleted due to missingness)
## Multiple R-squared:  0.3508, Adjusted R-squared:  0.3365 
## F-statistic: 24.55 on 9 and 409 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>plot(residuals(lm_pitching) ~ fitted.values(lm_pitching),
     main = &quot;Residuals vs. Fitted Values Plot for Pitching Model&quot;)
abline(0,0)</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-8-1.png" width="90%" /></p>
<pre class="r"><code>qqnorm(residuals(lm_pitching),
       main = &quot;Normal Q-Q Plot for Pitching Model&quot;)
qqline(residuals(lm_pitching))</code></pre>
<p><img src="Final_Report_Draft_files/figure-html/unnamed-chunk-8-2.png" width="90%" /></p>
<p>We decided to log-transform the salary variable because it is heavily
right-skewed, and decided to use <span
class="math inline">\(log_{10}\)</span> instead of <span
class="math inline">\(ln\)</span> for the sake of interpretability. We
included ERA+, the measure of a pitcher’s ERA relative to the league
average, as well as innings pitched (<code>ip_total</code>), walks per
nine innings (<code>bb9</code>) and strikeouts per nine innings
(<code>so9</code>); we used walks/strikeouts per nine innings since the
total number of walks/strikeouts would be highly correlated with the
number of innings pitched.</p>
<p>We accounted for pitcher handedness (right vs. left) as well as
pitcher type (the default type is a closing pitcher, with relief
pitchers and starting pitchers also included in the model). Finally, we
explored the interaction between handedness and pitcher type to see if
pitcher type affects the relationship between handedness and salary.</p>
<p>From our model, we can see that relief pitchers have significantly
lower salaries than closing pitchers, which makes sense, since closing
pitchers have very strong reputations as some of the most effective
pitchers in the game and therefore will draw high salaries.
Additionally, the <code>era_2</code> predictor, even when accounting for
pitcher handedness, pitcher type, and the number of innings pitched, has
an insignificant <span class="math inline">\(P\)</span>-value, implying
that there is no significant association between one of the most highly
regarded summative statistics for pitching effectiveness and pitcher
salary.</p>
<p>The residuals vs. fitted values plot shows that residuals are
slightly more likely to be positive when salary is low; this is likely
because of the large number of MLB players who are still on their rookie
contracts, and therefore make somewhere between $700,000 and $1,000,000
per year. The Normal Q-Q plot shows only minor deviations of the model’s
residuals from Normal behavior; the deviations between theoretical
quantities of -1 and 0.5 can also be explained by the players on their
rookie contracts.</p>
</div>
</div>
<div id="discussion" class="section level1">
<h1>Discussion</h1>
<p>What were your findings? Are they what you expect? What insights into
the data can you make?</p>
<p>Checking to see if committing works.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
