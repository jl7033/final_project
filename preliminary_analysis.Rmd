---
title: "preliminary_analysis"
author: "Joe LaRocca"
date: "2024-11-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(readxl)
```

```{r}

url = "https://www.spotrac.com/mlb/contracts"
read_html(url) |>
  html_table()

```

#### Salaries Dataset

```{r}

salaries = read_excel(
  "data/MLB-Salaries 2000-24.xlsx", 
  sheet = "2022.xls",
  skip = 1) |>
  select(1:4) |>
  rename(position = "Pos'n",
         salary_2022 = "2022.0",
         service_time_yrs = "MLS",
         name = "Player")%>%
  mutate(name = str_replace_all(name, "[*#\\.,]", ""))


```

#### Batting and Pitching Datasets

```{r}

batting = read_delim("data/2022 MLB Player Stats - Batting.csv", delim = ";",
                     locale = locale(encoding = "latin1")) |>
  janitor::clean_names()%>%
  filter(tm == "TOT")%>%
  mutate(name = str_replace_all(name, "[*#\\.]$", ""))
library(tidyverse)

batting <- batting %>%
  mutate(name = str_split(name, "\\s+")) %>% 
  mutate(name = map(name, rev)) %>%           
  mutate(name = map_chr(name, str_c, collapse = " ")) %>% 
  mutate(name = str_trim(name))               

merged_batting <- inner_join(salaries, batting, by = "name")



```

```{r}

pitching = read_delim("data/2022 MLB Player Stats - Pitching.csv", delim = ";",
                     locale = locale(encoding = "latin1")) |>
  janitor::clean_names()%>%
  filter(tm == "TOT")%>%
  filter(!str_detect(name, "[*#]$"))
library(tidyverse)

pitching <- pitching %>%
  mutate(name = str_split(name, "\\s+")) %>%  
  mutate(name = map(name, rev)) %>%           
  mutate(name = map_chr(name, str_c, collapse = " ")) %>% 
  mutate(name = str_trim(name))               
merged_pitching <- inner_join(salaries, pitching, by = "name")




```